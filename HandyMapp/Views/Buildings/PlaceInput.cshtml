
@{
    ViewData["Title"] = "PlaceInput";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="jumbotron text-center jumbotron-notFront">
    <div class="container">
        <svg class="stepDiactivated" width="10%" height="10%" viewBox="0 0 100 100" version="1.1" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;">
            <a class="step-breadcrumbs step-breadcrumbs" asp-controller="Buildings" asp-action="WayOfSearching" style="cursor: pointer;">
            <circle cx="50" cy="50" r="40.372" style="fill:#fff; stroke:#fff; stroke-width: 4px;" />
            <g id="_2" transform="matrix(1,0,0,1,3.75692,-2.72152)">
            <text x="27.164px" y="75.726px" style="font-family:'ArialMT', 'Arial', sans-serif;font-size:64.014px;fill:#1370B8; stroke:#1370B8;stroke-width:1px;">1</text>
                </g>
            </a>
        </svg>

        <svg class="stepActivated" width="10%" height="10%" viewBox="0 0 100 100" version="1.1" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;">
<a class="step-breadcrumbs">
<circle cx="50" cy="50" r="40.372" style="fill:#fff; stroke:#fff; stroke-width: 4px;" /><g id="_2" transform="matrix(1,0,0,1,3.75692,-2.72152)">
<text x="29.164px" y="75.726px" style="font-family:'ArialMT', 'Arial', sans-serif;font-size:64.014px;fill:#1370B8; stroke:#1370B8;stroke-width:1px;">2</text>
                </g>
            </a>
        </svg>
    <svg class="stepDiactivated" width="10%" height="10%" viewBox="0 0 100 100" version="1.1" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;">
    <circle cx="50" cy="50" r="40.372" style="fill:transparent; stroke:#fff; stroke-width: 4px;" /><g id="_2" transform="matrix(1,0,0,1,3.75692,-2.72152)">
    <text x="29.164px" y="75.726px" style="font-family:'ArialMT', 'Arial', sans-serif;font-size:64.014px;fill:#FFF; stroke:#FFF; stroke-width:1px">3</text>
      </g>
    </svg>
    </div>
</div>
<div class="description-container">
    <p class="description-text">Type in the start and end of your route:</p>
</div>
<br>
<div class="container form-container col-lg-6 col-lg-offset-3 col-md-6 col-md-offset-3 col-sm-6 col-sm-offset-3">
    <form asp-action="PlacesResult" asp-controller="Buildings">
        <div class="form-group">
            <label class="from-to">What do you like to find?</label>
            <input type="text" class="form-control search" placeholder="For example: Restaurant, Gemeentehuis of station.." autocomplete="on" autofocus>
        </div>
        <div id="hiddenForm" style="display: none"></div>
        <div class="col-sm-12 col-md-12 col-lg-12 form-button">
            <button class="btn btn-block btn-primary btn-lg">
                <span><span class="glyphicon glyphicon-ok-circle"></span>Route options</span>
            </button>
        </div>
    </form>
</div>

@section Scripts {
    <script type="text/javascript">
        var arrDescription = [];

        $(".search").keypress(function() {
            if ($(".search").val().length >= 3) {
                fillautocomplete();
            }
        });

        function fillautocomplete() {
            $.ajax({
                type: "GET",
                url: '/api/Places/AutoComplete/' + $(".search").val(),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (result) {
                    var form = "";
                    arrDescription = [];
                    for (var i = 0; i < result.predictions.length; i++) {
                        arrDescription.push(result.predictions[i].description);

                        form += '<input type="text" id="z' + i + '__Id" name="[' + i + '].Id" value="' + result.predictions[i].id + '">' +
                            '<input type="text" id="z' + i + '__PlaceId" name="[' + i + '].PlaceId" value="' + result.predictions[i].place_id + '">' +
                            '<input type="text" id="z' + i + '__Description" name="[' + i + '].Description" value="' + result.predictions[i].description + '">' +
                            '<input type="text" id="z' + i + '__Reference" name="[' + i + '].Reference" value="' + result.predictions[i].reference + '"><div> result terms</div>';
                        for (var j = 0; j < result.predictions[i].terms.length; j++) {
                                form += '<input type="text" id="z' + i + '__Terms_' + j + '__Value" name="[' + i + '].Terms[' + j + '].Value" value="' + result.predictions[i].terms[j].value+'">' +
                                    '<input type="text" id="z' + i + '__Terms_' + j + '__Offset" name="[' + i + '].Terms[' + j + '].Offset" value="' + result.predictions[i].terms[j].offset+'">';
                            }
                    }
                    document.getElementById('hiddenForm').innerHTML = form;
                },
                error: window.errorFunc
            }).done(function () {
                $(".search").autocomplete({
                    source: arrDescription,
                    position: { my: "left top ", at: "left+0 top+40" }
                });
            });
        }
    </script>
}

